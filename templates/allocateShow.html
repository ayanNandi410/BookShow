{% extends "baseTemplate.html" %}

{% block title %}Allocate Show{% endblock %}

{% block head %}
<style>
    .divider:after,
    .divider:before {
        content: "";
        flex: 1;
        height: 1px;
        background: #eee;
    }
    .h-custom {
        height: calc(100% - 73px);
    }
    @media (max-width: 450px) {
        .h-custom {
            height: 100%;
        }
    }
    .offcanvas{
        min-height: 90%;
    }
</style>
{% endblock %}

{% block content %} 

<div class="offcanvas offcanvas-bottom" tabindex="-1" id="chShowCanvas" aria-labelledby="offcanvasBottomLabel">
    <div class="offcanvas-header">
      <h5 class="offcanvas-title" id="offcanvasBottomLabel">Choose show</h5>
      <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body">
        {% if showListEmpty is defined %}
            <br/><br/><br/>
            <div class="col-6 offset-md-4 justify-content-center">
              <h3 class="alert alert-primary mb-4">No Shows Available</h3>
            </div>
        {% else %}
          <div class="row row-cols-1 row-cols-sm-4 g-4">
            {% for show in shows %}
            <div class="col">
              <div class="card">
                <div class="card-body">
                  <h5 class="card-title">{{ show['name'] }}</h5>
                  <p class="card-text">
                    <!-- <br/>Ticket Price : &nbsp;&#8377;{{ show['ticketPrice'] }}<br/>  -->
                    <div class="card-text ratings">
                      {% for i in range(1,6) %}
                        {% if(i <= (show['rating']/2)) %}
                          <i class="fa fa-star rating-color"></i>
                        {% else %}
                          <i class="fa fa-star"></i>
                        {% endif %}
                      {% endfor %}
                    </div>
                    {% for tagItem in show['tags'] %}
                    <span class="badge bg-secondary">{{ tagItem['name'] }}</span>&nbsp;
                    {% endfor %}<br/>
                    {% for tagItem in show['languages'] %}
                    <span class="badge bg-success">{{ tagItem['name'] }}</span>&nbsp;
                    {% endfor %}
                    </p>
                  <a href="#" class="btn btn-primary" data-columns="1" data-sname="{{ show['name'] }}" 
                  onclick="chooseShow();" data-bs-toggle="offcanvas" data-bs-target="#chShowCanvas">Choose Show</a>
                </div>
              </div>
            </div>
            {% endfor %}
          </div>
          {% endif %}
      </div>
</div>

<div class="body" style="margin-top: 10%; margin-bottom: 10%;">
    {% if response is defined %}
        {% if response == 'Success' %}
            <p class="alert alert-warning" role="alert" style="padding: 10px 20px;">Successfully added</p>
        {% else %}
            <p class="alert alert-warning" role="alert" style="padding: 10px 20px;">{{ response['error_code'] }} , 
                {{ response['error_message'] }}</p>
        {% endif %}
    {% endif %}
    <div class="container h-custom">
        <h2>Allocate Show</h2><hr/><br/>
      <div class="d-flex justify-content-center align-items-center h-100">

          <form class="mt-4" action="/admin/allocation/add" method="post" enctype=multipart/form-data>  
            <!-- Name input -->
            <div class="row mb-3">
                <div class="col-12 col-sm-6">
                    <div class="input-group input-group-md mb-3">
                        <span class="input-group-text" name="venueName">For Venue</span>
                        <input type="text" class="form-control" name="venueName" 
                        id="venueName" value="{{ vname }}" aria-label="venueName" disabled>
                    </div>
                </div>
            <div class="row mb-3">
                <div class="col-12 col-sm-6">
                    <div class="input-group input-group-md mb-3">
                        <span class="input-group-text" name="showName">For Show</span>
                        <input type="text" class="form-control" name="showName" id="showName" 
                        placeholder="Not choosen" aria-label="Show Name" value="" disabled>
                    </div>
                </div>
                <div class="col-12 col-sm-6">
                    <div class="col-4">
                        <button type="button" class="btn btn-success btn-md"
                        style="padding-left: 2.5rem; padding-right: 2.5rem;" 
                        data-bs-toggle="offcanvas" data-bs-target="#chShowCanvas" aria-controls="chShowCanvas">Choose Show</button>
                    </div>
                </div>
            </div>
            <!--
            <div class="row mb-3">
                <div class="input-group input-group-lg">
                    <input type="file" class="form-control" id="venueImage" name="venueImage">
                    <label class="input-group-text" for="venueImage">Upload Image</label>
                  </div>
            </div>
            -->

            
            <div class="row mb-3">
                <div class="col-6">
                    <div class="input-group input-group-md mb-3">
                        <span class="input-group-text" >Release Date</span>
                        <input type="date" class="form-control" name="showReleaseDate" 
                        id="showReleaseDate" aria-label="Show Release Date">
                    </div>
                </div>
            </div>

            <div class="row mb-3">
                <div class="col-6">
                    <div class="input-group input-group-md mb-3">
                        <span class="input-group-text" >Release Time</span>
                        <input type="time" class="form-control" name="showReleaseTime" 
                        id="showReleaseTime" min="06:00" max="23:00" required>
                    </div>
                </div>
            </div>

            <div class="row mb-3">
                <div class="col-5">
                    <div class="input-group input-group-md mb-3">
                        <span class="input-group-text" >Ticket Price</span>
                        <input type="number" step=".01" class="form-control" name="showTicketPrice" 
                        id="showTicketPrice" placeholder="450.00" aria-label="Show Ticket Price">
                    </div>
                </div>
            </div>

            <div class="row mb-3">
                <div class="col-4 offset-5">
                    <button type="submit" class="btn btn-primary btn-md"
                    style="padding-left: 2.5rem; padding-right: 2.5rem;">Allocate Show Timings</button>
                </div>
            </div>
  
          </form>
      </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    function chooseShow(){
        const showName = document.getElementById("showName");
        show = event.target;
        sName = show.dataset.sname;
        showName.value = sName;


    }
</script>
{% endblock %}